function Validator(a){this.formobj=document.forms[a];if(!this.formobj){alert("BUG: couldnot get Form object "+a);return}if(this.formobj.onsubmit){this.formobj.old_onsubmit=this.formobj.onsubmit;this.formobj.onsubmit=null}else{this.formobj.old_onsubmit=null}this.formobj.onsubmit=form_submit_handler;this.addValidation=add_validation;this.setAddnlValidationFunction=set_addnl_vfunction;this.clearAllValidations=clear_all_validations}function set_addnl_vfunction(a){this.formobj.addnlvalidation=a}function clear_all_validations(){for(var a=0;a<this.formobj.elements.length;a++){this.formobj.elements[a].validationset=null}}function form_submit_handler(){for(var itr=0;itr<this.elements.length;itr++){if(this.elements[itr].validationset&&!this.elements[itr].validationset.validate()){return false}}if(this.addnlvalidation){str=" var ret = "+this.addnlvalidation+"()";eval(str);if(!ret)return ret}return true}function add_validation(a,b,c){if(!this.formobj){alert("BUG: the form object is not set properly");return}var d=this.formobj[a];if(!d){alert("BUG: Couldnot get the input object named: "+a);return}if(!d.validationset){d.validationset=new ValidationSet(d)}d.validationset.add(b,c)}function ValidationDesc(a,b,c){this.desc=b;this.error=c;this.itemobj=a;this.validate=vdesc_validate}function vdesc_validate(){if(!V2validateData(this.desc,this.itemobj,this.error)){this.itemobj.focus();return false}return true}function ValidationSet(a){this.vSet=new Array;this.add=add_validationdesc;this.validate=vset_validate;this.itemobj=a}function add_validationdesc(a,b){this.vSet[this.vSet.length]=new ValidationDesc(this.itemobj,a,b)}function vset_validate(){for(var a=0;a<this.vSet.length;a++){if(!this.vSet[a].validate()){return false}}return true}function validateEmailv2(a){if(a.length<=0){return true}var b=a.match("^(.+)@(.+)$");if(b==null)return false;if(b[1]!=null){var c=/^\"?[\w-_\.]*\"?$/;if(b[1].match(c)==null)return false}if(b[2]!=null){var d=/^[\w-\.]*\.[A-Za-z]{2,4}$/;if(b[2].match(d)==null){var e=/^\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\]$/;if(b[2].match(e)==null)return false}return true}return false}function trim(a){return a.replace(/^\s+|\s+$/g,"")}function V2validateData(strValidateStr,objValue,strError){var epos=strValidateStr.search("=");var command="";var cmdvalue="";if(epos>=0){command=strValidateStr.substring(0,epos);cmdvalue=strValidateStr.substr(epos+1)}else{command=strValidateStr}switch(command){case"req":case"required":{if(eval(trim(objValue.value).length)==0){if(!strError||strError.length==0){strError=objValue.name+" : Required Field"}alert(strError);return false}break};case"maxlength":case"maxlen":{if(eval(objValue.value.length)>eval(cmdvalue)){if(!strError||strError.length==0){strError=objValue.name+" : "+cmdvalue+" characters maximum "}alert(strError+"\n[Current length = "+objValue.value.length+" ]");return false}break};case"minlength":case"minlen":{if(eval(objValue.value.length)<eval(cmdvalue)){if(!strError||strError.length==0){strError=objValue.name+" : "+cmdvalue+" characters minimum  "}alert(strError+"\n[Current length = "+objValue.value.length+" ]");return false}break};case"alnum":case"alphanumeric":{var charpos=objValue.value.search("[^A-Za-z0-9]");if(objValue.value.length>0&&charpos>=0){if(!strError||strError.length==0){strError=objValue.name+": Only alpha-numeric characters allowed "}alert(strError+"\n [Error character position "+eval(charpos+1)+"]");return false}break};case"num":case"numeric":{var charpos=objValue.value.search("[^0-9]");if(objValue.value.length>0&&charpos>=0){if(!strError||strError.length==0){strError=objValue.name+": Only digits allowed "}alert(strError+"\n [Error character position "+eval(charpos+1)+"]");return false}break};case"alphabetic":case"alpha":{var charpos=objValue.value.search("[^A-Za-z]");if(objValue.value.length>0&&charpos>=0){if(!strError||strError.length==0){strError=objValue.name+": Only alphabetic characters allowed "}alert(strError+"\n [Error character position "+eval(charpos+1)+"]");return false}break};case"alnumhyphen":{var charpos=objValue.value.search("[^A-Za-z0-9-_]");if(objValue.value.length>0&&charpos>=0){if(!strError||strError.length==0){strError=objValue.name+": characters allowed are A-Z,a-z,0-9,- and _"}alert(strError+"\n [Error character position "+eval(charpos+1)+"]");return false}break};case"email":{if(!validateEmailv2(objValue.value)){if(!strError||strError.length==0){strError=objValue.name+": Enter a valid Email address "}alert(strError);return false}break};case"lt":case"lessthan":{if(isNaN(objValue.value)){alert(objValue.name+": Should be a number ");return false}if(eval(objValue.value)>=eval(cmdvalue)){if(!strError||strError.length==0){strError=objValue.name+" : value should be less than "+cmdvalue}alert(strError);return false}break};case"gt":case"greaterthan":{if(isNaN(objValue.value)){alert(objValue.name+": Should be a number ");return false}if(eval(objValue.value)<=eval(cmdvalue)){if(!strError||strError.length==0){strError=objValue.name+" : value should be greater than "+cmdvalue}alert(strError);return false}break};case"regexp":{if(objValue.value.length>0){if(!objValue.value.match(cmdvalue)){if(!strError||strError.length==0){strError=objValue.name+": Invalid characters found "}alert(strError);return false}}break};case"dontselect":{if(objValue.selectedIndex==null){alert("BUG: dontselect command for non-select Item");return false}if(objValue.selectedIndex==eval(cmdvalue)){if(!strError||strError.length==0){strError=objValue.name+": Please Select one option "}alert(strError);return false}break}}return true}function checkEquality(a,b,c,d){this.formobj=document.forms[a];if(!this.formobj){alert("BUG: the form object is not set properly");return}var e=this.formobj[b];var f=this.formobj[c];if(!e||!e){alert("BUG: Couldnot get the input objects"+b+" or "+c);return}if(e.value!=f.value){alert(d);return false}}function checkDate(a,b,c,d){this.formobj=document.forms[a];if(!this.formobj){alert("BUG: the form object is not set properly");return}var e=this.formobj[b];var f=this.formobj[c];if(e.value!=null&&e.value!=""){if(!validateDate(e.value)){alert(d);return false}}if(f.value!=null&&f.value!=""){if(!validateDate(f.value)){alert(d);return false}}return true}function validateDate(a){if(/[0-9]{1,2}\/[0-9]{1,2}\/[0-9]{4}/.test(a)){return true}else{return false}}